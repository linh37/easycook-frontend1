{"remainingRequest":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/src/pages/Post/Post.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/src/pages/Post/Post.vue","mtime":1621061284959},{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBiYWNrZXIgZnJvbSAiLi4vLi4vdXRpbHMvYXhpb3MiOwppbXBvcnQgSGVhZGVyIGZyb20gIi4uLy4uL2NvbXBvbmVudHMvSGVhZGVyIjsKaW1wb3J0IHZTZWxlY3QgZnJvbSAidnVlLXNlbGVjdCI7CmltcG9ydCAidnVlLXNlbGVjdC9kaXN0L3Z1ZS1zZWxlY3QuY3NzIjsKaW1wb3J0IEZvb3RlciBmcm9tICIuLi8uLi9jb21wb25lbnRzL0Zvb3RlciI7CgppbXBvcnQgQ0tFZGl0b3IgZnJvbSAiQGNrZWRpdG9yL2NrZWRpdG9yNS12dWUyIjsKaW1wb3J0IENsYXNzaWNFZGl0b3IgZnJvbSAiQGNrZWRpdG9yL2NrZWRpdG9yNS1idWlsZC1jbGFzc2ljIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhZG1pbjogdGhpcy4kc3RvcmUuc3RhdGUudXNlci5yb2xlLAogICAgICBwb3N0OiB7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgY29udGVudDogIiIsCiAgICAgICAgY2F0ZWdvcnlfaWQ6ICIiLAogICAgICAgIGltYWdlOiAiIiwKICAgICAgfSwKICAgICAgaW1hZ2U6ICIiLAogICAgICBjYXRlZ29yaWVzOiBbXSwKICAgICAgZXJyb3JzOiB7fSwKICAgICAgZWRpdG9yOiBDbGFzc2ljRWRpdG9yLAogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEhlYWRlciwKICAgIHZTZWxlY3QsCiAgICBGb290ZXIsCiAgICBja2VkaXRvcjogQ0tFZGl0b3IuY29tcG9uZW50LAogIH0sCiAgbWV0aG9kczogewogICAgZmFpbHVyZTogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KAogICAgICAgIGBYdeG6pXQgaGnhu4duIGzhu5dpLCB2dWkgbMOybmcga2nhu4NtIHRyYSB2w6AgdGnhur9uIGjDoG5oIGPhuq1wIG5o4bqtdCBs4bqhaS5gLAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiBgQ8OzIGzhu5dpYCwKICAgICAgICAgIHZhcmlhbnQ6ICJkYW5nZXIiLAogICAgICAgICAgc29saWQ6IHRydWUsCiAgICAgICAgfQogICAgICApOwogICAgfSwKCiAgICBsb2FkQ2F0ZWdvcnk6IGZ1bmN0aW9uIChwYWdlID0gMSkgewogICAgICBiYWNrZXIuZ2V0KGBjYXRlZ29yeT9wYWdlPSR7cGFnZX0mcGVyX3BhZ2U9MTAwMGApLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgdGhpcy5jYXRlZ29yaWVzID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBsb2FkSW5ncmVkaWVudDogZnVuY3Rpb24gKG5hbWUgPSAiIikgewogICAgICBiYWNrZXIuZ2V0KGBpbmdyZWRpZW50P3NlYXJjaD0ke25hbWV9YCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICB0aGlzLmluZ3JlZGllbnRzID0gcmVzcG9uc2UuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgb25GaWxlOiBmdW5jdGlvbiAoZSkgewogICAgICB0aGlzLnBvc3QuaW1hZ2UgPSBlLnRhcmdldC5maWxlc1swXTsKICAgICAgdGhpcy5jcmVhdGVJbWFnZSh0aGlzLnBvc3QuaW1hZ2UpOwogICAgfSwKICAgIGNyZWF0ZUltYWdlOiBmdW5jdGlvbiAoZmlsZSkgewogICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgcmVhZGVyLm9ubG9hZCA9IChlKSA9PiB7CiAgICAgICAgdm0uaW1hZ2UgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgIH07CiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgfSwKICAgIGhhbmRsZTogZnVuY3Rpb24gKCkgewogICAgICBsZXQgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgIGxldCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGlmICh0aGlzLnBvc3QuaW1hZ2UpIGRhdGEuYXBwZW5kKCJpbWFnZSIsIHRoaXMucG9zdC5pbWFnZSk7CiAgICAgIGRhdGEuYXBwZW5kKCJuYW1lIiwgdGhpcy5wb3N0Lm5hbWUpOwogICAgICBkYXRhLmFwcGVuZCgiY29udGVudCIsIHRoaXMucG9zdC5jb250ZW50KTsKICAgICAgZGF0YS5hcHBlbmQoImNhdGVnb3J5X2lkIiwgdGhpcy5wb3N0LmNhdGVnb3J5X2lkLmlkKTsKCiAgICAgIGNvbnN0IGNvbmZpZyA9IHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiY29udGVudC10eXBlIjogIm11bHRpcGFydC9mb3JtLWRhdGEiLAogICAgICAgIH0sCiAgICAgIH07CgogICAgICBiYWNrZXIKICAgICAgICAucG9zdCgicG9zdC8iICsgaWQsIGRhdGEsIGNvbmZpZykKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cykgewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJob21lIiB9KTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIHRoaXMuZXJyb3JzID0gZXJyb3IucmVzcG9uc2UuZGF0YTsKICAgICAgICAgIHRoaXMuZmFpbHVyZSgpOwogICAgICAgIH0pOwogICAgfSwKICAgIGxvYWRQb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgIGxldCBpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgICAgYmFja2VyLmdldChgcG9zdC8ke2lkfWApLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzKSB7CiAgICAgICAgICB0aGlzLnBvc3QubmFtZSA9IHJlc3BvbnNlLmRhdGEucG9zdC5uYW1lOwogICAgICAgICAgdGhpcy5wb3N0LmNvbnRlbnQgPSByZXNwb25zZS5kYXRhLnBvc3QuY29udGVudDsKICAgICAgICAgIHRoaXMucG9zdC5jYXRlZ29yeV9pZCA9IHJlc3BvbnNlLmRhdGEucG9zdC5jYXRlZ29yeV9pZDsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jYXRlZ29yaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmNhdGVnb3JpZXNbaV0uaWQgPT0gdGhpcy5wb3N0LmNhdGVnb3J5X2lkKSB7CiAgICAgICAgICAgICAgdGhpcy5wb3N0LmNhdGVnb3J5X2lkID0gdGhpcy5jYXRlZ29yaWVzW2ldOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5sb2FkQ2F0ZWdvcnkoKTsKICAgIHRoaXMubG9hZEluZ3JlZGllbnQoKTsKICAgIHRoaXMubG9hZFBvc3QoKTsKICB9LAp9Owo="},{"version":3,"sources":["Post.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Post.vue","sourceRoot":"src/pages/Post","sourcesContent":["<template>\n  <div>\n    <Header />\n    <div class=\"container\">\n      <div class=\"row\">\n        <div class=\"col-xl-12 border border-info p-5 mt-5 mb-5\">\n          <form enctype=\"multipart/form-data\" @submit.prevent=\"handle()\">\n            <div class=\"form-group\">\n              <label class=\"form-control-label\">Tên công thức: </label>\n              <input\n                type=\"text\"\n                name=\"name\"\n                class=\"form-control\"\n                v-model=\"post.name\"\n              />\n            </div>\n\n            <div v-if=\"image\">\n              Hình ảnh mẫu:\n              <br />\n              <img :src=\"image\" class=\"img-responsive\" />\n            </div>\n            <label class=\"form-control-label\">Hình ảnh: </label>\n            <input\n              type=\"file\"\n              name=\"image\"\n              class=\"form-control-file\"\n              @change=\"onFile\"\n            />\n\n            <br />\n\n            <div class=\"form-group\">\n              <label class=\"form-control-label\">Nội dung: </label>\n              <ckeditor\n                :editor=\"editor\"\n                class=\"form-control\"\n                name=\"content\"\n                height=\"500px\"\n                v-model=\"post.content\"\n              ></ckeditor>\n            </div>\n\n            <div class=\"form-group\">\n              <label class=\"form-control-label\">Chuyên mục: </label>\n              <v-select\n                v-model=\"post.category_id\"\n                :options=\"categories\"\n                label=\"name\"\n              >\n              </v-select>\n            </div>\n            <div v-if=\"errors.errors\">\n              <div\n                class=\"alert alert-danger\"\n                v-for=\"error in errors.errors\"\n                :key=\"error.id\"\n              >\n                {{ error[0] }}\n              </div>\n            </div>\n\n            <div class=\"alert alert-info\" v-if=\"errors.message\">\n              {{ errors.message }}\n            </div>\n            <div class=\"d-flex align-items-center\">\n              <button type=\"submit\" class=\"btn btn-outline-primary\">\n                Cập nhật công thức\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n    <Footer />\n  </div>\n</template>\n<script>\nimport backer from \"../../utils/axios\";\nimport Header from \"../../components/Header\";\nimport vSelect from \"vue-select\";\nimport \"vue-select/dist/vue-select.css\";\nimport Footer from \"../../components/Footer\";\n\nimport CKEditor from \"@ckeditor/ckeditor5-vue2\";\nimport ClassicEditor from \"@ckeditor/ckeditor5-build-classic\";\nexport default {\n  data() {\n    return {\n      admin: this.$store.state.user.role,\n      post: {\n        name: \"\",\n        content: \"\",\n        category_id: \"\",\n        image: \"\",\n      },\n      image: \"\",\n      categories: [],\n      errors: {},\n      editor: ClassicEditor,\n    };\n  },\n  components: {\n    Header,\n    vSelect,\n    Footer,\n    ckeditor: CKEditor.component,\n  },\n  methods: {\n    failure: function () {\n      this.$bvToast.toast(\n        `Xuất hiện lỗi, vui lòng kiểm tra và tiến hành cập nhật lại.`,\n        {\n          title: `Có lỗi`,\n          variant: \"danger\",\n          solid: true,\n        }\n      );\n    },\n\n    loadCategory: function (page = 1) {\n      backer.get(`category?page=${page}&per_page=1000`).then((response) => {\n        this.categories = response.data.data;\n      });\n    },\n    loadIngredient: function (name = \"\") {\n      backer.get(`ingredient?search=${name}`).then((response) => {\n        this.ingredients = response.data;\n      });\n    },\n    onFile: function (e) {\n      this.post.image = e.target.files[0];\n      this.createImage(this.post.image);\n    },\n    createImage: function (file) {\n      let reader = new FileReader();\n      let vm = this;\n      reader.onload = (e) => {\n        vm.image = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    },\n    handle: function () {\n      let id = this.$route.params.id;\n      let data = new FormData();\n      if (this.post.image) data.append(\"image\", this.post.image);\n      data.append(\"name\", this.post.name);\n      data.append(\"content\", this.post.content);\n      data.append(\"category_id\", this.post.category_id.id);\n\n      const config = {\n        headers: {\n          \"content-type\": \"multipart/form-data\",\n        },\n      };\n\n      backer\n        .post(\"post/\" + id, data, config)\n        .then((response) => {\n          if (response.data.status) {\n            this.$router.push({ name: \"home\" });\n          }\n        })\n        .catch((error) => {\n          this.errors = error.response.data;\n          this.failure();\n        });\n    },\n    loadPost: function () {\n      let id = this.$route.params.id;\n      backer.get(`post/${id}`).then((response) => {\n        if (response.data.status) {\n          this.post.name = response.data.post.name;\n          this.post.content = response.data.post.content;\n          this.post.category_id = response.data.post.category_id;\n          for (let i = 0; i < this.categories.length; i++) {\n            if (this.categories[i].id == this.post.category_id) {\n              this.post.category_id = this.categories[i];\n            }\n          }\n        }\n      });\n    },\n  },\n  mounted() {\n    this.loadCategory();\n    this.loadIngredient();\n    this.loadPost();\n  },\n};\n</script>\n<style>\n.ck-editor__editable {\n  min-height: 500px;\n}\n</style>"]}]}