{"remainingRequest":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/src/pages/Post/View.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/src/pages/Post/View.vue","mtime":1621061284959},{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/linhnguyen/Desktop/EasyCook1/easy_cook-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBiYWNrZXIgZnJvbSAiLi4vLi4vdXRpbHMvYXhpb3MiOwoKaW1wb3J0IEhlYWRlciBmcm9tICIuLi8uLi9jb21wb25lbnRzL0hlYWRlciI7CmltcG9ydCBGb290ZXIgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9Gb290ZXIiOwoKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtb21lbnQ6IG1vbWVudCwKICAgICAgY2F0ZWdvcnk6IHt9LAogICAgICBwb3N0OiB7fSwKICAgICAgdGV4dDogIiIsCiAgICAgIHBvc3RzOiB7fSwKICAgICAgZXJyb3JzOiAiIiwKICAgICAgaW5ncmVkaWVudHM6IHt9LAogICAgICBsaWtlOiB7fSwKICAgICAgY29tbWVudDogIiIsCiAgICAgIGlkOiB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQsCiAgICAgIHVzZXI6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuaWQsCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGFkbWluKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUudXNlci5yb2xlOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGxpa2VQb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5pbmdyZWRpZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICh0aGlzLmluZ3JlZGllbnRzW2ldLm1haW4pIHsKICAgICAgICAgIGxldCBkYXRhID0gewogICAgICAgICAgICBpbmdyZWRpZW50OiB0aGlzLmluZ3JlZGllbnRzW2ldLmluZ3JlZGllbnRfaWQsCiAgICAgICAgICAgIHBvc3Q6IHRoaXMuaWQsCiAgICAgICAgICB9OwogICAgICAgICAgYmFja2VyLnBvc3QoYGluZ3JlZGllbnRfdXNlci8ke3RoaXMudXNlcn1gLCBkYXRhKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5sb2FkUG9zdCgpOwogICAgICB9CiAgICB9LAoKICAgIGRpc2xpa2VQb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5pbmdyZWRpZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICh0aGlzLmluZ3JlZGllbnRzW2ldLm1haW4pIHsKICAgICAgICAgIGxldCBpbmdyZWRpZW50SWQgPSB0aGlzLmluZ3JlZGllbnRzW2ldLmluZ3JlZGllbnRfaWQ7CiAgICAgICAgICBiYWNrZXIuZGVsZXRlKAogICAgICAgICAgICBgaW5ncmVkaWVudF91c2VyLyR7dGhpcy51c2VyfT9pbmdyZWRpZW50PSR7aW5ncmVkaWVudElkfSZwb3N0PSR7dGhpcy5pZH1gCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmxvYWRQb3N0KCk7CiAgICB9LAoKICAgIHBvc3RDb21tZW50OiBmdW5jdGlvbiAoKSB7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIGNvbnRlbnQ6IHRoaXMudGV4dCwKICAgICAgICBwb3N0OiB0aGlzLmlkLAogICAgICAgIHVzZXI6IHRoaXMudXNlciwKICAgICAgfTsKICAgICAgYmFja2VyCiAgICAgICAgLnBvc3QoImNvbW1lbnQiLCBkYXRhKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzKSB7CiAgICAgICAgICAgIHRoaXMudGV4dCA9ICIiOwogICAgICAgICAgICB0aGlzLmVycm9ycyA9ICIiOwogICAgICAgICAgICB0aGlzLmxvYWRQb3N0KCk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9yLnJlc3BvbnNlLmRhdGE7CiAgICAgICAgfSk7CiAgICB9LAogICAgbG9hZFBvc3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgYmFja2VyLmdldChgcG9zdC8ke3RoaXMuaWR9P3VzZXI9JHt0aGlzLnVzZXJ9YCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMpIHsKICAgICAgICAgIHRoaXMucG9zdCA9IHJlc3BvbnNlLmRhdGEucG9zdDsKICAgICAgICAgIHRoaXMuaW5ncmVkaWVudHMgPSByZXNwb25zZS5kYXRhLmluZ3JlZGllbnRzOwogICAgICAgICAgdGhpcy5saWtlID0gcmVzcG9uc2UuZGF0YS5saWtlOwogICAgICAgICAgdGhpcy5jb21tZW50ID0gcmVzcG9uc2UuZGF0YS5jb21tZW50OwoKICAgICAgICAgIGJhY2tlci5nZXQoYGNhdGVnb3J5LyR7dGhpcy5wb3N0LmNhdGVnb3J5X2lkfWApLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcnkgPSByZXNwb25zZS5kYXRhLmNhdGVnb3J5OwogICAgICAgICAgICB0aGlzLnBvc3RzID0gcmVzcG9uc2UuZGF0YS5wb3N0czsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZGVsZXRlUG9zdDogZnVuY3Rpb24gKGlkKSB7CiAgICAgIGxldCBjaG9vc2UgPSBjb25maXJtKCJC4bqhbiBjw7MgdGjhu7FjIHPhu7EgbXXhu5FuIHjDs2EgY8O0bmcgdGjhu6ljIG7DoHkga2jDtG5nID8iKTsKICAgICAgaWYgKGNob29zZSA9PSB0cnVlKQogICAgICAgIGJhY2tlci5kZWxldGUoInBvc3QvIiArIGlkKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzKSB7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogImhvbWUiIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKCiAgICBkZWxldGVDb21tZW50OiBmdW5jdGlvbiAoaWQpIHsKICAgICAgbGV0IGNob29zZSA9IGNvbmZpcm0oIkLhuqFuIGPDsyB0aOG7sWMgc+G7sSBtdeG7kW4geMOzYSBiw6xuaCBsdeG6rW4gbsOgeSBraMO0bmcgPyIpOwogICAgICBpZiAoY2hvb3NlID09IHRydWUpCiAgICAgICAgYmFja2VyLmRlbGV0ZSgiY29tbWVudC8iICsgaWQpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMpIHsKICAgICAgICAgICAgdGhpcy5sb2FkUG9zdCgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKCiAgICBlZGl0UG9zdDogZnVuY3Rpb24gKGlkKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAicG9zdCIsCiAgICAgICAgcGFyYW1zOiB7IGlkIH0sCiAgICAgIH0pOwogICAgfSwKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEhlYWRlciwKICAgIEZvb3RlciwKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmxvYWRQb3N0KCk7CiAgfSwKfTsK"},{"version":3,"sources":["View.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuIA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"View.vue","sourceRoot":"src/pages/Post","sourcesContent":["<template>\n  <div id=\"app\">\n    <Header />\n    <div class=\"mt-5 container\">\n      <div class=\"row\">\n        <div class=\"col-xl-6\">\n          <img class=\"img-fluid\" :src=\"post.image\" alt=\"\" />\n        </div>\n        <div class=\"col-xl-6 text-dark\">\n          <p>\n            <b-icon icon=\"pencil-square\" class=\"mr-1\" /> Công thức:\n            <b class=\"h5 font-weight-bolder\">{{ post.name }}</b>\n          </p>\n          <p>\n            <b-icon icon=\"folder\" class=\"mr-1\" /> Chuyên mục:\n            {{ category.name }}\n          </p>\n          <p>\n            <b-icon icon=\"calendar\" class=\"mr-1\" />Ngày đăng:\n            {{ moment(post.updated_at).format(\"DD-MM-YYYY\") }}\n          </p>\n          <p>\n            <b-icon icon=\"clock\" class=\"mr-1\" />Giờ đăng:\n            {{ moment(post.updated_at).format(\"h:mm a\") }}\n          </p>\n          <div v-if=\"admin == 'admin'\">\n            <span @click=\"editPost(post.id)\" class=\"btn btn-success btn-lg mr-2\"\n              >Chỉnh sửa</span\n            >\n            <span @click=\"deletePost(post.id)\" class=\"btn btn-danger btn-lg\"\n              >Xóa</span\n            >\n          </div>\n          <div v-if=\"admin == 'user'\">\n            <div v-if=\"!like && ingredients.length > 0\">\n              <span class=\"btn btn-danger btn-lg\" @click=\"likePost\"\n                ><b-icon icon=\"heart-fill\" />Yêu thích</span\n              >\n            </div>\n            <div v-else>\n              <span class=\"btn btn-outline-warning btn-lg\" @click=\"dislikePost\"\n                >Hủy yêu thích</span\n              >\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col-xl-12\">\n          <div class=\"border p-5\">\n            <div class=\"p-2\">\n              <h2><b>Nguyên liệu</b></h2>\n              <b-list-group>\n                <b-list-group-item\n                  v-for=\"(ingredient, index) in ingredients\"\n                  :key=\"index\"\n                >\n                  <b>{{ ingredient.name }}:</b> {{ ingredient.quantity }}\n                  {{ ingredient.unit }}\n                </b-list-group-item>\n              </b-list-group>\n            </div>\n            <div v-html=\"post.content\" class=\"p-2\"></div>\n          </div>\n        </div>\n      </div>\n      <div class=\"row\" v-if=\"admin == 'user'\">\n        <div class=\"mt-5 h2 font-weight-bolder\">Để lại bình luận</div>\n        <div class=\"col-xl-12\">\n          <div class=\"border border-info p-2\">\n            <div v-if=\"errors.errors\">\n              <div\n                class=\"alert alert-danger\"\n                v-for=\"error in errors.errors\"\n                :key=\"error.id\"\n              >\n                {{ error[0] }}\n              </div>\n            </div>\n\n            <div class=\"alert alert-info\" v-if=\"errors.message\">\n              {{ errors.message }}\n            </div>\n            <b-form-textarea\n              id=\"textarea\"\n              v-model=\"text\"\n              placeholder=\"Để lại bình luận\"\n              rows=\"5\"\n              max-rows=\"10\"\n            ></b-form-textarea>\n            <button class=\"btn btn-lg mt-2 btn-info\" @click=\"postComment\">\n              Bình luận\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"row\" v-if=\"comment.length > 0\">\n        <div class=\"mt-5 h2 font-weight-bolder\">Bình luận</div>\n\n        <div\n          class=\"col-xl-12 border p-2 m-1 d-flex align-items-center\"\n          v-for=\"(one, index) in comment\"\n          :key=\"index\"\n        >\n          <img\n            class=\"img-fluid\"\n            :src=\"one.image\"\n            alt=\"\"\n            height=\"100px\"\n            width=\"100px\"\n          />\n          <div class=\"m-1\">\n            <div class=\"mb-2\">\n              <span class=\"text-primary font-weight-bolder h4\">\n                {{ one.name }}\n              </span>\n\n              {{ moment(one.created_at).format(\"DD-MM-YYYY h:mm a\") }}\n              <span\n                class=\"btn btn-danger\"\n                @click=\"deleteComment(one.id)\"\n                v-if=\"admin == 'admin'\"\n                >Xóa bình luận</span\n              >\n            </div>\n            <hr />\n            <div class=\"\">{{ one.content }}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <Footer />\n  </div>\n</template>\n<script>\nimport backer from \"../../utils/axios\";\n\nimport Header from \"../../components/Header\";\nimport Footer from \"../../components/Footer\";\n\nimport moment from \"moment\";\n\nexport default {\n  data() {\n    return {\n      moment: moment,\n      category: {},\n      post: {},\n      text: \"\",\n      posts: {},\n      errors: \"\",\n      ingredients: {},\n      like: {},\n      comment: \"\",\n      id: this.$route.params.id,\n      user: this.$store.state.user.id,\n    };\n  },\n  computed: {\n    admin() {\n      return this.$store.state.user.role;\n    },\n  },\n  methods: {\n    likePost: function () {\n      for (let i = 0; i < this.ingredients.length; i++) {\n        if (this.ingredients[i].main) {\n          let data = {\n            ingredient: this.ingredients[i].ingredient_id,\n            post: this.id,\n          };\n          backer.post(`ingredient_user/${this.user}`, data);\n        }\n        this.loadPost();\n      }\n    },\n\n    dislikePost: function () {\n      for (let i = 0; i < this.ingredients.length; i++) {\n        if (this.ingredients[i].main) {\n          let ingredientId = this.ingredients[i].ingredient_id;\n          backer.delete(\n            `ingredient_user/${this.user}?ingredient=${ingredientId}&post=${this.id}`\n          );\n        }\n      }\n      this.loadPost();\n    },\n\n    postComment: function () {\n      let data = {\n        content: this.text,\n        post: this.id,\n        user: this.user,\n      };\n      backer\n        .post(\"comment\", data)\n        .then((response) => {\n          if (response.data.status) {\n            this.text = \"\";\n            this.errors = \"\";\n            this.loadPost();\n          }\n        })\n        .catch((error) => {\n          this.errors = error.response.data;\n        });\n    },\n    loadPost: function () {\n      backer.get(`post/${this.id}?user=${this.user}`).then((response) => {\n        if (response.data.status) {\n          this.post = response.data.post;\n          this.ingredients = response.data.ingredients;\n          this.like = response.data.like;\n          this.comment = response.data.comment;\n\n          backer.get(`category/${this.post.category_id}`).then((response) => {\n            this.category = response.data.category;\n            this.posts = response.data.posts;\n          });\n        }\n      });\n    },\n    deletePost: function (id) {\n      let choose = confirm(\"Bạn có thực sự muốn xóa công thức này không ?\");\n      if (choose == true)\n        backer.delete(\"post/\" + id).then((response) => {\n          if (response.data.status) {\n            this.$router.push({ name: \"home\" });\n          }\n        });\n    },\n\n    deleteComment: function (id) {\n      let choose = confirm(\"Bạn có thực sự muốn xóa bình luận này không ?\");\n      if (choose == true)\n        backer.delete(\"comment/\" + id).then((response) => {\n          if (response.data.status) {\n            this.loadPost();\n          }\n        });\n    },\n\n    editPost: function (id) {\n      this.$router.push({\n        name: \"post\",\n        params: { id },\n      });\n    },\n  },\n  components: {\n    Header,\n    Footer,\n  },\n  mounted() {\n    this.loadPost();\n  },\n};\n</script>\n<style scoped>\n</style>\n"]}]}